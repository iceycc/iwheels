## 初始化项目

`lerna init `

## 配置文件

npmClient选用yarn，npm也可以。

useWorkspaces开启工作目录

learn.js

```json
{
  "packages": [
    "packages/*",
    "packages/react/*",
    "packages/tools/*",
    "examples/*"
  ],
  "version": "0.0.1",
  "useWorkspaces": true,
  "npmClient": "yarn"
}

```

Package.json

```json
{
  "name": "iwheels",
  "private": true,
  "publishConfig": {
    "access": "public"
  },
  "workspaces": [
    ".",
    "packages/*",
    "packages/react/*",
    "packages/tools/*",
    "examples/*"
  ]
}

```



## 创建项目目录

  - examples: 存放demo项目
  - packages：存放轮子源码

## 设置工作目录

```json
// lerna.json
  "packages": [
    "packages/*",
    "packages/react/*",
    "packages/tools/*",
    "examples/*"
  ]

```

```json
  "workspaces": [
    ".",
    "packages/*",
    "packages/react/*",
    "packages/tools/*",
    "examples/*"
  ]
```



## 创建项目包：

提前创建所有packages

```shell
## react相关
lerna create @iwheels/react-error-boundary packages/react
lerna create @iwheels/react-infinite-scroller packages/react 
lerna create @iwheels/react-contenteditable packages/react
lerna create @iwheels/redux packages/react
lerna create @iwheels/redux-thunk packages/react

## tools
lerna create @iwheels/js-cookie packages/tools
lerna create @iwheels/idb-keyval packages/tools
lerna create @iwheels/copy-to-clipboard packages/tools
lerna create @iwheels/promise-poller packages/tools
lerna create @iwheels/supertest packages/tools
```



## 安装公共依赖

## webpack项目

会在根目录添加，同时会在当前所有子包内的package.json添加

```shell
lerna add webpack-cli -D
lerna add webpack -D
lerna add webpack-dev-server -D

```

统一安装webpack5版本

## bable相关

```shell
lerna add @babel/cli -D
lerna add @babel/core -D
lerna add @babel/preset-env -D
lerna add babel-loader -D
lerna add ts-loader -D
lerna add typescript -D
```



## rollup相关

npm i -D @rollup/plugin-commonjs @rollup/plugin-node-resolve  @rollup/plugin-typescript @rollup/plugin-babel rollup-plugin-livereload rollup-plugin-serve rollup-plugin-terser

```shell
lerna add @rollup/plugin-commonjs --dev packages/tools/* 
lerna add @rollup/plugin-node-resolve --dev packages/tools/* 
lerna add @rollup/plugin-typescript --dev packages/tools/* 
lerna add @rollup/plugin-babel --dev packages/tools/* 
lerna add rollup-plugin-livereload --dev packages/tools/* 
lerna add rollup-plugin-terser --dev packages/tools/* 
lerna add rollup-plugin-serve --dev packages/tools/*

```



## react相关

命名规范，react相关的以react开头：`@iwheels/react-xxx`，方便批量给react相关项目增加依赖

```
leran add react packages/react-*
```





